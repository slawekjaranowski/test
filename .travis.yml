language: java
jdk:
  - oraclejdk8

before_install:
    - curl https://raw.githubusercontent.com/s4u/parent/travis/settings.xml -o ../settings.xml


install: true

script:
    - export IS_RELEASE=`git log -1 --pretty=%s | grep "\[maven-release-plugin\] prepare release"`
    - echo "$IS_RELEASE"
    -
        if [ -z "$TRAVIS_TAG" -a -z "$IS_RELEASE" ]; then
            if [ "$TRAVIS_PULL_REQUEST" = "false" -a "$TRAVIS_BRANCH" = "master" ]; then
                $_MVN clean install;
            else
                $_MVN clean verify;
            fi
        fi

env:
    global:
        - _MVN='mvn -B -V -e -s ../settings.xml'
        - secure: "MFG0Vc4n/k24wsUqkm5WMBUWnrgAVW286QSUx3qK50Vcnyyim8spEHvdPnlHWejpwtwsj1SLF6w2SiZ+gEorikfoL/ioMuIh2KvvWwe40tSQOdN68qPn/NGsAt/+sxMObHT+HPt0NGEUqeYVg7xWDpeUs7PW3jnqkbBH/n/nEvk="